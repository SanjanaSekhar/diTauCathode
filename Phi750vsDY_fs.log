Is GPU available?  True
(15868, 38) (20343, 38)
(15868, 29) (20343, 29)
Min, max m_tt in sig:  17.538218 2847.946289
Min, max m_tt in bkg1:  15.110117 1072.036621
No. of samples in SR in sig, bkg
11664 270
No. of bkg samples in data and pure bkg
135 135
No of signal samples to inject into bkg1 =  33
(33, 29)
train_sig.shape, train_bkg1.shape, train_bkg1_ws.shape =  (26, 28) (108, 28) (108, 28)
Phi750vsDY_fs : Weak supervision -  train, val, test shapes:  (134, 28) (16, 28) (18, 28)
Final samples before training starts
Phi750vsDY_fs: train, val, test shapes:  (242, 28) (29, 28) (32, 28)
[[ 1.458244  2.945086 -0.076373 ...  0.        1.        1.      ]
 [ 0.454811 -0.843272 -1.01005  ...  0.        1.        1.      ]
 [-1.219887 -0.127457  1.738543 ...  0.36935   0.63065   1.      ]
 ...
 [ 0.589886  3.06846   1.785494 ...  0.        0.        0.      ]
 [-0.286825 -1.874489  0.515935 ...  0.40337   0.59663   0.      ]
 [ 1.427821  1.119006  0.563948 ...  0.419538  0.580462  0.      ]] [[ 1.458244  2.945086 -0.076373 ...  0.        1.        1.      ]
 [ 0.454811 -0.843272 -1.01005  ...  0.        1.        1.      ]
 [-1.219887 -0.127457  1.738543 ...  0.36935   0.63065   1.      ]
 ...
 [ 0.589886  3.06846   1.785494 ...  0.        0.        0.      ]
 [-0.286825 -1.874489  0.515935 ...  0.40337   0.59663   0.      ]
 [ 1.427821  1.119006  0.563948 ...  0.419538  0.580462  0.      ]]
================= Training Phi750vsDY_fs =================
  0%|          | 0/4 [00:00<?, ?batch/s]Epoch 0:   0%|          | 0/4 [00:00<?, ?batch/s]Epoch 0:  25%|██▌       | 1/4 [00:01<00:04,  1.61s/batch]Epoch 0:  25%|██▌       | 1/4 [00:01<00:04,  1.61s/batch]Epoch 0:  50%|█████     | 2/4 [00:01<00:01,  1.38batch/s]Epoch 0:  50%|█████     | 2/4 [00:01<00:01,  1.38batch/s]Epoch 0:  75%|███████▌  | 3/4 [00:01<00:00,  2.26batch/s]Epoch 0:  75%|███████▌  | 3/4 [00:01<00:00,  2.26batch/s]Epoch 0: 100%|██████████| 4/4 [00:01<00:00,  3.24batch/s]Epoch 0: 100%|██████████| 4/4 [00:01<00:00,  2.08batch/s]
Train Loss: 0.518723
Val Loss: 0.501315
  0%|          | 0/4 [00:00<?, ?batch/s]Epoch 1:   0%|          | 0/4 [00:00<?, ?batch/s]Epoch 1:  25%|██▌       | 1/4 [00:00<00:00,  9.51batch/s]Epoch 1:  25%|██▌       | 1/4 [00:00<00:00,  9.51batch/s]Epoch 1:  50%|█████     | 2/4 [00:00<00:00,  9.50batch/s]Epoch 1:  50%|█████     | 2/4 [00:00<00:00,  9.50batch/s]Epoch 1:  75%|███████▌  | 3/4 [00:00<00:00,  9.51batch/s]Epoch 1:  75%|███████▌  | 3/4 [00:00<00:00,  9.51batch/s]Epoch 1: 100%|██████████| 4/4 [00:00<00:00,  9.53batch/s]Epoch 1: 100%|██████████| 4/4 [00:00<00:00,  9.51batch/s]
Train Loss: 0.398673
Val Loss: 0.446917
  0%|          | 0/4 [00:00<?, ?batch/s]Epoch 2:   0%|          | 0/4 [00:00<?, ?batch/s]Epoch 2:  25%|██▌       | 1/4 [00:00<00:00,  9.37batch/s]Epoch 2:  25%|██▌       | 1/4 [00:00<00:00,  9.37batch/s]Epoch 2:  50%|█████     | 2/4 [00:00<00:00,  9.47batch/s]Epoch 2:  50%|█████     | 2/4 [00:00<00:00,  9.47batch/s]Epoch 2:  75%|███████▌  | 3/4 [00:00<00:00,  9.49batch/s]Epoch 2:  75%|███████▌  | 3/4 [00:00<00:00,  9.49batch/s]Epoch 2: 100%|██████████| 4/4 [00:00<00:00,  9.53batch/s]Epoch 2: 100%|██████████| 4/4 [00:00<00:00,  9.50batch/s]
Train Loss: 0.447094
Val Loss: 0.437488
  0%|          | 0/4 [00:00<?, ?batch/s]Epoch 3:   0%|          | 0/4 [00:00<?, ?batch/s]Epoch 3:  25%|██▌       | 1/4 [00:00<00:00,  9.46batch/s]Epoch 3:  25%|██▌       | 1/4 [00:00<00:00,  9.46batch/s]Epoch 3:  50%|█████     | 2/4 [00:00<00:00,  9.55batch/s]Epoch 3:  50%|█████     | 2/4 [00:00<00:00,  9.55batch/s]Epoch 3:  75%|███████▌  | 3/4 [00:00<00:00,  9.53batch/s]Epoch 3:  75%|███████▌  | 3/4 [00:00<00:00,  9.53batch/s]Epoch 3: 100%|██████████| 4/4 [00:00<00:00,  9.49batch/s]Epoch 3: 100%|██████████| 4/4 [00:00<00:00,  9.49batch/s]
Train Loss: 0.405856
Val Loss: 0.461354
  0%|          | 0/4 [00:00<?, ?batch/s]Epoch 4:   0%|          | 0/4 [00:00<?, ?batch/s]Epoch 4:  25%|██▌       | 1/4 [00:00<00:00,  9.66batch/s]Epoch 4:  25%|██▌       | 1/4 [00:00<00:00,  9.66batch/s]Epoch 4:  50%|█████     | 2/4 [00:00<00:00,  9.56batch/s]Epoch 4:  50%|█████     | 2/4 [00:00<00:00,  9.56batch/s]Epoch 4:  75%|███████▌  | 3/4 [00:00<00:00,  9.53batch/s]Epoch 4:  75%|███████▌  | 3/4 [00:00<00:00,  9.53batch/s]Epoch 4: 100%|██████████| 4/4 [00:00<00:00,  9.51batch/s]Epoch 4: 100%|██████████| 4/4 [00:00<00:00,  9.52batch/s]
Train Loss: 0.401879
Val Loss: 0.446202
  0%|          | 0/4 [00:00<?, ?batch/s]Epoch 5:   0%|          | 0/4 [00:00<?, ?batch/s]Epoch 5:  25%|██▌       | 1/4 [00:00<00:00,  9.59batch/s]Epoch 5:  25%|██▌       | 1/4 [00:00<00:00,  9.59batch/s]Epoch 5:  50%|█████     | 2/4 [00:00<00:00,  9.49batch/s]Epoch 5:  50%|█████     | 2/4 [00:00<00:00,  9.49batch/s]Epoch 5:  75%|███████▌  | 3/4 [00:00<00:00,  9.45batch/s]Epoch 5:  75%|███████▌  | 3/4 [00:00<00:00,  9.45batch/s]Epoch 5: 100%|██████████| 4/4 [00:00<00:00,  9.42batch/s]Epoch 5: 100%|██████████| 4/4 [00:00<00:00,  9.44batch/s]
Train Loss: 0.363027
Val Loss: 0.458794
  0%|          | 0/4 [00:00<?, ?batch/s]Epoch 6:   0%|          | 0/4 [00:00<?, ?batch/s]Epoch 6:  25%|██▌       | 1/4 [00:00<00:00,  9.39batch/s]Epoch 6:  25%|██▌       | 1/4 [00:00<00:00,  9.39batch/s]Epoch 6:  50%|█████     | 2/4 [00:00<00:00,  9.53batch/s]Epoch 6:  50%|█████     | 2/4 [00:00<00:00,  9.53batch/s]Epoch 6:  75%|███████▌  | 3/4 [00:00<00:00,  9.56batch/s]Epoch 6:  75%|███████▌  | 3/4 [00:00<00:00,  9.56batch/s]Epoch 6: 100%|██████████| 4/4 [00:00<00:00,  9.55batch/s]Epoch 6: 100%|██████████| 4/4 [00:00<00:00,  9.52batch/s]
Train Loss: 0.353676
Val Loss: 0.470196
  0%|          | 0/4 [00:00<?, ?batch/s]Epoch 7:   0%|          | 0/4 [00:00<?, ?batch/s]Epoch 7:  25%|██▌       | 1/4 [00:00<00:00,  9.52batch/s]Epoch 7:  25%|██▌       | 1/4 [00:00<00:00,  9.52batch/s]Epoch 7:  50%|█████     | 2/4 [00:00<00:00,  9.53batch/s]Epoch 7:  50%|█████     | 2/4 [00:00<00:00,  9.53batch/s]Epoch 7:  75%|███████▌  | 3/4 [00:00<00:00,  9.50batch/s]Epoch 7:  75%|███████▌  | 3/4 [00:00<00:00,  9.50batch/s]Epoch 7: 100%|██████████| 4/4 [00:00<00:00,  9.52batch/s]Epoch 7: 100%|██████████| 4/4 [00:00<00:00,  9.51batch/s]
Train Loss: 0.348198
Val Loss: 0.478580
  0%|          | 0/4 [00:00<?, ?batch/s]Epoch 8:   0%|          | 0/4 [00:00<?, ?batch/s]Epoch 8:  25%|██▌       | 1/4 [00:00<00:00,  9.55batch/s]Epoch 8:  25%|██▌       | 1/4 [00:00<00:00,  9.55batch/s]Epoch 8:  50%|█████     | 2/4 [00:00<00:00,  9.51batch/s]Epoch 8:  50%|█████     | 2/4 [00:00<00:00,  9.51batch/s]Epoch 8:  75%|███████▌  | 3/4 [00:00<00:00,  9.48batch/s]Epoch 8:  75%|███████▌  | 3/4 [00:00<00:00,  9.48batch/s]Epoch 8: 100%|██████████| 4/4 [00:00<00:00,  9.45batch/s]Epoch 8: 100%|██████████| 4/4 [00:00<00:00,  9.46batch/s]
Train Loss: 0.316168
Val Loss: 0.492137
  0%|          | 0/4 [00:00<?, ?batch/s]Epoch 9:   0%|          | 0/4 [00:00<?, ?batch/s]Epoch 9:  25%|██▌       | 1/4 [00:00<00:00,  9.44batch/s]Epoch 9:  25%|██▌       | 1/4 [00:00<00:00,  9.44batch/s]Epoch 9:  50%|█████     | 2/4 [00:00<00:00,  9.48batch/s]Epoch 9:  50%|█████     | 2/4 [00:00<00:00,  9.48batch/s]Epoch 9:  75%|███████▌  | 3/4 [00:00<00:00,  9.46batch/s]Epoch 9:  75%|███████▌  | 3/4 [00:00<00:00,  9.46batch/s]Epoch 9: 100%|██████████| 4/4 [00:00<00:00,  9.47batch/s]Epoch 9: 100%|██████████| 4/4 [00:00<00:00,  9.45batch/s]
Train Loss: 0.302676
Val Loss: 0.497527
  0%|          | 0/4 [00:00<?, ?batch/s]Epoch 10:   0%|          | 0/4 [00:00<?, ?batch/s]Epoch 10:  25%|██▌       | 1/4 [00:00<00:00,  9.42batch/s]Epoch 10:  25%|██▌       | 1/4 [00:00<00:00,  9.42batch/s]Epoch 10:  50%|█████     | 2/4 [00:00<00:00,  9.44batch/s]Epoch 10:  50%|█████     | 2/4 [00:00<00:00,  9.44batch/s]Epoch 10:  75%|███████▌  | 3/4 [00:00<00:00,  9.44batch/s]Epoch 10:  75%|███████▌  | 3/4 [00:00<00:00,  9.44batch/s]Epoch 10: 100%|██████████| 4/4 [00:00<00:00,  9.49batch/s]Epoch 10: 100%|██████████| 4/4 [00:00<00:00,  9.45batch/s]
Train Loss: 0.314649
Val Loss: 0.470090
  0%|          | 0/4 [00:00<?, ?batch/s]Epoch 11:   0%|          | 0/4 [00:00<?, ?batch/s]Epoch 11:  25%|██▌       | 1/4 [00:00<00:00,  9.52batch/s]Epoch 11:  25%|██▌       | 1/4 [00:00<00:00,  9.52batch/s]Epoch 11:  50%|█████     | 2/4 [00:00<00:00,  9.49batch/s]Epoch 11:  50%|█████     | 2/4 [00:00<00:00,  9.49batch/s]Epoch 11:  75%|███████▌  | 3/4 [00:00<00:00,  9.45batch/s]Epoch 11:  75%|███████▌  | 3/4 [00:00<00:00,  9.45batch/s]Epoch 11: 100%|██████████| 4/4 [00:00<00:00,  9.47batch/s]Epoch 11: 100%|██████████| 4/4 [00:00<00:00,  9.46batch/s]
Train Loss: 0.286784
Val Loss: 0.457612
  0%|          | 0/4 [00:00<?, ?batch/s]Epoch 12:   0%|          | 0/4 [00:00<?, ?batch/s]Epoch 12:  25%|██▌       | 1/4 [00:00<00:00,  9.54batch/s]Epoch 12:  25%|██▌       | 1/4 [00:00<00:00,  9.54batch/s]Epoch 12:  50%|█████     | 2/4 [00:00<00:00,  9.60batch/s]Epoch 12:  50%|█████     | 2/4 [00:00<00:00,  9.60batch/s]Epoch 12:  75%|███████▌  | 3/4 [00:00<00:00,  9.61batch/s]Epoch 12:  75%|███████▌  | 3/4 [00:00<00:00,  9.61batch/s]Epoch 12: 100%|██████████| 4/4 [00:00<00:00,  9.57batch/s]Epoch 12: 100%|██████████| 4/4 [00:00<00:00,  9.57batch/s]
Train Loss: 0.269461
Val Loss: 0.563201
  0%|          | 0/4 [00:00<?, ?batch/s]Epoch 13:   0%|          | 0/4 [00:00<?, ?batch/s]Epoch 13:  25%|██▌       | 1/4 [00:00<00:00,  9.43batch/s]Epoch 13:  25%|██▌       | 1/4 [00:00<00:00,  9.43batch/s]Epoch 13:  50%|█████     | 2/4 [00:00<00:00,  9.46batch/s]Epoch 13:  50%|█████     | 2/4 [00:00<00:00,  9.46batch/s]Epoch 13:  75%|███████▌  | 3/4 [00:00<00:00,  9.42batch/s]Epoch 13:  75%|███████▌  | 3/4 [00:00<00:00,  9.42batch/s]Epoch 13: 100%|██████████| 4/4 [00:00<00:00,  9.45batch/s]Epoch 13: 100%|██████████| 4/4 [00:00<00:00,  9.43batch/s]
Train Loss: 0.278852
Val Loss: 0.514403
  0%|          | 0/4 [00:00<?, ?batch/s]Epoch 14:   0%|          | 0/4 [00:00<?, ?batch/s]Epoch 14:  25%|██▌       | 1/4 [00:00<00:00,  9.43batch/s]Epoch 14:  25%|██▌       | 1/4 [00:00<00:00,  9.43batch/s]Epoch 14:  50%|█████     | 2/4 [00:00<00:00,  9.45batch/s]Epoch 14:  50%|█████     | 2/4 [00:00<00:00,  9.45batch/s]Epoch 14:  75%|███████▌  | 3/4 [00:00<00:00,  9.48batch/s]Epoch 14:  75%|███████▌  | 3/4 [00:00<00:00,  9.48batch/s]Epoch 14: 100%|██████████| 4/4 [00:00<00:00,  9.49batch/s]Epoch 14: 100%|██████████| 4/4 [00:00<00:00,  9.47batch/s]
Train Loss: 0.246204
Val Loss: 0.527812
  0%|          | 0/4 [00:00<?, ?batch/s]Epoch 15:   0%|          | 0/4 [00:00<?, ?batch/s]Epoch 15:  25%|██▌       | 1/4 [00:00<00:00,  9.51batch/s]Epoch 15:  25%|██▌       | 1/4 [00:00<00:00,  9.51batch/s]Epoch 15:  50%|█████     | 2/4 [00:00<00:00,  9.56batch/s]Epoch 15:  50%|█████     | 2/4 [00:00<00:00,  9.56batch/s]Epoch 15:  75%|███████▌  | 3/4 [00:00<00:00,  9.50batch/s]Epoch 15:  75%|███████▌  | 3/4 [00:00<00:00,  9.50batch/s]Epoch 15: 100%|██████████| 4/4 [00:00<00:00,  9.57batch/s]Epoch 15: 100%|██████████| 4/4 [00:00<00:00,  9.54batch/s]
Train Loss: 0.242774
Val Loss: 0.550336
  0%|          | 0/4 [00:00<?, ?batch/s]Epoch 16:   0%|          | 0/4 [00:00<?, ?batch/s]Epoch 16:  25%|██▌       | 1/4 [00:00<00:00,  9.48batch/s]Epoch 16:  25%|██▌       | 1/4 [00:00<00:00,  9.48batch/s]Epoch 16:  50%|█████     | 2/4 [00:00<00:00,  9.52batch/s]Epoch 16:  50%|█████     | 2/4 [00:00<00:00,  9.52batch/s]Epoch 16:  75%|███████▌  | 3/4 [00:00<00:00,  9.48batch/s]Epoch 16:  75%|███████▌  | 3/4 [00:00<00:00,  9.48batch/s]Epoch 16: 100%|██████████| 4/4 [00:00<00:00,  9.47batch/s]Epoch 16: 100%|██████████| 4/4 [00:00<00:00,  9.47batch/s]
Train Loss: 0.234872
Val Loss: 0.631712
  0%|          | 0/4 [00:00<?, ?batch/s]Epoch 17:   0%|          | 0/4 [00:00<?, ?batch/s]Epoch 17:  25%|██▌       | 1/4 [00:00<00:00,  9.42batch/s]Epoch 17:  25%|██▌       | 1/4 [00:00<00:00,  9.42batch/s]Epoch 17:  50%|█████     | 2/4 [00:00<00:00,  9.56batch/s]Epoch 17:  50%|█████     | 2/4 [00:00<00:00,  9.56batch/s]Epoch 17:  75%|███████▌  | 3/4 [00:00<00:00,  9.51batch/s]Epoch 17:  75%|███████▌  | 3/4 [00:00<00:00,  9.51batch/s]Epoch 17: 100%|██████████| 4/4 [00:00<00:00,  9.50batch/s]Epoch 17: 100%|██████████| 4/4 [00:00<00:00,  9.49batch/s]
Train Loss: 0.218304
Val Loss: 0.574982
  0%|          | 0/4 [00:00<?, ?batch/s]Epoch 18:   0%|          | 0/4 [00:00<?, ?batch/s]Epoch 18:  25%|██▌       | 1/4 [00:00<00:00,  9.47batch/s]Epoch 18:  25%|██▌       | 1/4 [00:00<00:00,  9.47batch/s]Epoch 18:  50%|█████     | 2/4 [00:00<00:00,  9.44batch/s]Epoch 18:  50%|█████     | 2/4 [00:00<00:00,  9.44batch/s]Epoch 18:  75%|███████▌  | 3/4 [00:00<00:00,  9.49batch/s]Epoch 18:  75%|███████▌  | 3/4 [00:00<00:00,  9.49batch/s]Epoch 18: 100%|██████████| 4/4 [00:00<00:00,  9.47batch/s]Epoch 18: 100%|██████████| 4/4 [00:00<00:00,  9.45batch/s]
Train Loss: 0.216287
Val Loss: 0.613468
  0%|          | 0/4 [00:00<?, ?batch/s]Epoch 19:   0%|          | 0/4 [00:00<?, ?batch/s]Epoch 19:  25%|██▌       | 1/4 [00:00<00:00,  9.45batch/s]Epoch 19:  25%|██▌       | 1/4 [00:00<00:00,  9.45batch/s]Epoch 19:  50%|█████     | 2/4 [00:00<00:00,  9.54batch/s]Epoch 19:  50%|█████     | 2/4 [00:00<00:00,  9.54batch/s]Epoch 19:  75%|███████▌  | 3/4 [00:00<00:00,  9.57batch/s]Epoch 19:  75%|███████▌  | 3/4 [00:00<00:00,  9.57batch/s]Epoch 19: 100%|██████████| 4/4 [00:00<00:00,  9.57batch/s]Epoch 19: 100%|██████████| 4/4 [00:00<00:00,  9.54batch/s]
Train Loss: 0.203369
Val Loss: 0.669909
========== TRAINING COMPLETE ===========
